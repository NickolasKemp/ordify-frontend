<div *ngIf="order$ | async as order" class="order-details">
	<button
		(click)="confirmCancelDialog()"
		mat-icon-button
		class="order-details__delete-btn"
	>
		<mat-icon>delete_outline</mat-icon>
	</button>

	<h1 class="order-details__title">Order details</h1>

	<!-- Order Status Section -->
	<div class="order-details__status-section order-details__section">
		<div class="status-header">
			<span>Status:</span>
			<span class="status-badge" [ngClass]="getStatusClass(order.status)">
				{{ getStatusLabel(order.status) }}
			</span>
		</div>

		<mat-form-field appearance="outline" class="status-select">
			<mat-label>Change status</mat-label>
			<mat-select
				[value]="order.status || 'pending'"
				(selectionChange)="onStatusChange(order._id, $event.value)"
				[disabled]="isUpdating()"
			>
				<mat-option *ngFor="let status of orderStatuses" [value]="status.value">
					{{ status.label }}
				</mat-option>
			</mat-select>
		</mat-form-field>

		<button
			*ngIf="order.status !== 'completed'"
			mat-raised-button
			color="primary"
			(click)="completeOrder(order._id)"
			[disabled]="isUpdating()"
			class="complete-btn"
		>
			<mat-icon>check_circle</mat-icon>
			Complete Order
		</button>

		<div *ngIf="order.completedAt" class="completed-info">
			<span>Completed: {{ order.completedAt | date: "medium" }}</span>
		</div>
	</div>

	<hr class="solid" />

	<div class="order-details__order-data order-details__section">
		<span>Date</span>
		<p>{{ order.created_at | date }}</p>
		<span>Delivery</span>
		<p>{{ order.deliveryWay }}</p>
		<span>Total</span>
		<p>{{ order.price | currency }}</p>
	</div>

	<hr class="solid" />

	<div
		*ngIf="order.customer"
		class="order-details__customer-data order-details__section"
	>
		<p>{{ order.customer.name }}</p>
		<p>{{ order.customer.contactPerson }}</p>
		<p>
			{{ order.customer.street }}, {{ order.customer.city }},
			{{ order.customer.state }}, {{ order.customer.zip }}
		</p>
	</div>

	<hr class="solid" />

	<div
		*ngIf="order.product"
		class="order-details__product-data order-details__section"
	>
		<p>{{ order.product.name }}</p>
		<p>{{ order.quantity }}</p>
	</div>
	<hr class="solid" />

	<div class="order-details__actions order-details__section">
		<button (click)="pdf.generateOrderPdf(order)" mat-flat-button>
			Download as PDF
		</button>
	</div>
</div>
