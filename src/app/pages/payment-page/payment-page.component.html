<div class="confirmation-container">
	<!-- Loading State -->
	<div *ngIf="isLoading()" class="loading-state">
		<mat-spinner diameter="50"></mat-spinner>
		<p>Loading order details...</p>
	</div>

	<!-- Error State -->
	<div *ngIf="error() && !isLoading()" class="error-state">
		<mat-icon class="error-icon">error_outline</mat-icon>
		<h2>Something went wrong</h2>
		<p>{{ error() }}</p>
		<button mat-raised-button color="primary" (click)="goToProducts()">
			Back to Products
		</button>
	</div>

	<!-- Success State with Order Details -->
	<mat-card
		*ngIf="order() && !isLoading() && !error()"
		class="confirmation-card"
	>
		<mat-card-header>
			<div class="success-header">
				<mat-icon class="success-icon">check_circle</mat-icon>
				<div>
					<mat-card-title>Дякуємо за замовлення!</mat-card-title>
					<mat-card-subtitle>Thank you for your order!</mat-card-subtitle>
				</div>
			</div>
		</mat-card-header>

		<mat-card-content>
			<div class="order-details">
				<h3>Order Details</h3>

				<div class="detail-row">
					<span class="label">Order Number:</span>
					<span class="value order-id">{{ order()?._id }}</span>
				</div>

				<div class="detail-row">
					<span class="label">Date:</span>
					<span class="value">{{ order()?.created_at | date: "medium" }}</span>
				</div>

				<div class="divider"></div>

				<div class="detail-row">
					<span class="label">Product:</span>
					<span class="value">{{ order()?.product?.name }}</span>
				</div>

				<div class="detail-row">
					<span class="label">Quantity:</span>
					<span class="value">{{ order()?.quantity }}</span>
				</div>

				<div class="detail-row">
					<span class="label">Delivery Method:</span>
					<span class="value">{{
						getDeliveryLabel(order()?.deliveryWay || "")
					}}</span>
				</div>

				<div class="divider"></div>

				<div class="detail-row total-row">
					<span class="label">Total Amount:</span>
					<span class="value total-price">{{ order()?.price | currency }}</span>
				</div>

				<div class="detail-row">
					<span class="label">Payment Status:</span>
					<span
						class="value status-badge"
						[ngClass]="getPaymentStatusClass(order()?.paymentStatus)"
					>
						{{ getPaymentStatusLabel(order()?.paymentStatus) }}
					</span>
				</div>

				<div *ngIf="order()?.paidAt" class="detail-row">
					<span class="label">Paid At:</span>
					<span class="value">{{ order()?.paidAt | date: "medium" }}</span>
				</div>
			</div>

			<div class="customer-info">
				<h3>Delivery Information</h3>

				<div class="detail-row">
					<span class="label">Customer:</span>
					<span class="value">{{ order()?.customer?.name }}</span>
				</div>

				<div class="detail-row">
					<span class="label">Contact:</span>
					<span class="value">{{ order()?.customer?.contactPerson }}</span>
				</div>

				<div class="detail-row">
					<span class="label">Phone:</span>
					<span class="value">{{ order()?.customer?.phone }}</span>
				</div>

				<div class="detail-row">
					<span class="label">Address:</span>
					<span class="value">
						{{ order()?.customer?.street }}, {{ order()?.customer?.city }},
						{{ order()?.customer?.state }} {{ order()?.customer?.zip }}
					</span>
				</div>
			</div>
		</mat-card-content>

		<mat-card-actions>
			<button mat-raised-button color="primary" (click)="goToProducts()">
				<mat-icon>shopping_bag</mat-icon>
				Continue Shopping
			</button>
		</mat-card-actions>
	</mat-card>

	<!-- Success State without Order Details (fallback) -->
	<mat-card
		*ngIf="!order() && !isLoading() && !error()"
		class="confirmation-card simple-success"
	>
		<mat-card-header>
			<div class="success-header">
				<mat-icon class="success-icon">check_circle</mat-icon>
				<div>
					<mat-card-title>Order Placed Successfully!</mat-card-title>
					<mat-card-subtitle>Your order has been confirmed</mat-card-subtitle>
				</div>
			</div>
		</mat-card-header>

		<mat-card-content>
			<p class="success-message">
				Thank you for your order. You will receive a confirmation email shortly.
			</p>
		</mat-card-content>

		<mat-card-actions>
			<button mat-raised-button color="primary" (click)="goToProducts()">
				<mat-icon>shopping_bag</mat-icon>
				Continue Shopping
			</button>
		</mat-card-actions>
	</mat-card>
</div>
